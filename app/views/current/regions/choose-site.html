<!-- File: app/views/test-page.html -->
{% extends 'layout.html' %}

{% block head %}
<!-- Include the accessible-autocomplete CSS from CDN -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/accessible-autocomplete@2.0.4/dist/accessible-autocomplete.min.css">
{% endblock %}

{% block content %}
<div class="nhsuk-width-container">
  <main class="nhsuk-main-wrapper" id="main-content">
    <div class="nhsuk-grid-row">
      <div class="nhsuk-grid-column-two-thirds">
        <h1>Site selection</h1>
        
        <form method="post" action="check-and-add-site">
          <div class="nhsuk-form-group">
            <label class="nhsuk-label" for="location">
             Enter a site name or ODS code
            </label>
            
            <div class="nhsuk-hint" id="location-hint">
              Start typing to see suggestions
            </div>
            
            <div id="location-container"></div>
            <input type="hidden" name="location" id="location-hidden">
          </div>
          
          <button class="nhsuk-button" type="submit">Continue</button>
        </form>
      </div>
    </div>
  </main>
</div>
{% endblock %}

{% block bodyEnd %}
<!-- Include the accessible-autocomplete JS from CDN -->
<script src="https://cdn.jsdelivr.net/npm/accessible-autocomplete@2.0.4/dist/accessible-autocomplete.min.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    if (typeof accessibleAutocomplete !== 'undefined') {
      // Initialize the autocomplete directly
      accessibleAutocomplete({
        element: document.getElementById('location-container'),
        id: 'location',
        source: ['London', 'Manchester', 'Birmingham', 'Hornsea Central Pharmacy', 'Leeds', 'Liverpool'],
        displayMenu: 'overlay',
        confirmOnBlur: true,
        onConfirm: function(selectedItem) {
          document.getElementById('location-hidden').value = selectedItem;
        }
      });
    } else {
      console.error('Accessible Autocomplete library not loaded');
    }
  });
</script>
{% endblock %}